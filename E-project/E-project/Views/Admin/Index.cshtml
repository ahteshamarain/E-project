
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}





<div class="app-main__outer">
    <div class="app-main__inner">
        <div class="app-page-title">
            <div class="page-title-wrapper">
                <div class="page-title-heading">

                    <div>
                        Bank Payment Voucher

                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content">
            <div class="tab-pane tabs-animation fade show active" id="tab-content-0" role="tabpanel">
                <div class="main-card mb-3 card">
                    <div class="card-body">
                        <div style="display: flex; justify-content: end;">
                            <a href="">
                                <button class="mt-2 btn btn-info" type="reset">Back</button>
                            </a>
                        </div>
                        <form method="post">
                          
                            <div class="form-row">

                                <div class="col-md-6">
                                    <div class="position-relative form-group">
                                        <label for="bank">Select Bank</label>
                                        <div class="">
                                            <select name="bank" id="bank" class="form-control">
                                            
                                                <option value="">hdh</option>
                                             
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="position-relative form-group">
                                        <label for="method">Select Method</label>
                                        <div class="">
                                            <select name="method" id="method" class="form-control">
                                                <option value="Online">Online</option>
                                                <option value="Cheque">Cheque</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="position-relative form-group">
                                        <label for="cheque_no">Enter Cheque or Transaction Number</label>
                                        <input type="text" id="cheque_no" name="cheque_no" min="0"
                                               class="form-control">
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="position-relative form-group">
                                        <label for="amount">Enter Amount Paid</label>
                                        <input type="number" step="0.01" id="amount" name="amount" min="0"
                                               class="form-control" required>
                                    </div>
                                </div>

                            </div>

                            <button class="mt-2 btn btn-danger" type="reset">Reset</button>
                            <button class="mt-2 btn btn-primary" type="submit">Submit</button>

                         @*    <div class="main-card mb-3 card">
                                <div class="card-body">
                                    <table style="width: 100%;" id="example"
                                           class="table table-hover table-striped table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Select</th>
                                                <th>Invoice ID</th>
                                                <th>Vendor Name</th>
                                                <th>Date</th>
                                                <th>Amount</th>
                                                <th>Balance</th>
                                                <th>All Paid</th>
                                                <th>Recv Amount</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for record in invoices %}
                                            <tr>
                                                <td>

                                                    <input type="checkbox" name="selected_invoices"
                                                           id="selected_invoices_{{ record.id }}"
                                                           value="{{ record.id }}">
                                                </td>
                                                <td>{{ record.invoice_id }}</td>
                                                <td>{{ record.vendor.name }}</td>
                                                <td>{{ record.created_at }}</td>
                                                <td> {{ record.total_amount|floatformat:2 }}</td>
                                                <td id="balance_{{ record.id }}">{{ record.balance|floatformat:2 }}</td>
                                                <td>
                                                    <input type="checkbox" name="all_recv_{{ record.id }}"
                                                           id="all_recv_{{ record.id }}"
                                                           value="{{ record.balance }}">
                                                </td>
                                                <td>
                                                    <input type="number" step="0.01" name="amounts_{{ record.id }}"
                                                           class="form-control" placeholder="Enter Amount">
                                                </td>
                                            </tr>
                                          
                                        </tbody>
                                    </table>
                                </div>
                            </div> *@
                        </form>


                    </div>
                </div>

            </div>

        </div>
    </div>
</div>
@* 
<script>

    const choice = new Choices('#bank', {
        searchEnabled: true,
        position: 'bottom'
    });
    document.addEventListener('DOMContentLoaded', function () {
        const amt = document.getElementById('amount');
        let totalSum = 0;

        const checkboxes = document.querySelectorAll('input[type="checkbox"][name="selected_invoices"]');

        checkboxes.forEach(function (checkbox) {
            const amountInput = document.querySelector(`input[name="amounts_${checkbox.value}"]`);
            const all_check = document.querySelector(`input[name="all_recv_${checkbox.value}"]`);
            const balance = parseFloat(document.querySelector(`#balance_${checkbox.value}`).innerText);

            // Initial disabling of amount input if checkbox is not checked
            if (!checkbox.checked) {
                amountInput.disabled = true;
                all_check.disabled = true;
            }

            // Event listener for checkbox change
            checkbox.addEventListener('change', function () {
                if (checkbox.checked) {
                    amountInput.disabled = false;
                    all_check.disabled = false;
                    amountInput.value = ''; // Clear the amount field if enabled
                } else {
                    totalSum -= parseFloat(amountInput.value) || 0; // Deduct unchecked amount from total
                    amountInput.disabled = true;
                    all_check.disabled = true;
                    amountInput.value = '';
                }
                updateTotalSum();
            });

            // Event listener for amount input change
            amountInput.addEventListener('input', function () {
                let inputAmount = parseFloat(amountInput.value) || 0;
                if (inputAmount > balance) {
                    alert(`Entered amount cannot be greater than the balance: ${balance}`);
                    amountInput.value = balance;
                    inputAmount = balance;
                }
                updateTotalSum();
            });

            // Event listener for "All Received" checkbox
            all_check.addEventListener('change', function () {
                if (all_check.checked) {
                    amountInput.value = balance;
                } else {
                    amountInput.value = '';
                }
                updateTotalSum();
            });

            function updateTotalSum() {
                totalSum = 0;
                checkboxes.forEach(function (cb) {
                    const input = document.querySelector(`input[name="amounts_${cb.value}"]`);
                    if (cb.checked) {
                        totalSum += parseFloat(input.value) || 0;
                    }
                });
                amt.value = totalSum.toFixed(2); // Update the total amount field
            }
        });
    });
</script>
{% endblock %} *@


